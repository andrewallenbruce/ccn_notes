---
output: html_document
editor_options: 
  chunk_output_type: console
---
# OPOs

```{r setup}
#| message: false
#| warning: false
#| echo: false
#| cache: false
#| comment: ""
library(ccn)
source("code/gt_theme.R")
```

```{r}
#| label: pkg-version
#| echo: false
paste("ccn version:", sQuote(utils::packageVersion("ccn")), "loaded") |> cat()
```

Organ procurement organizations (OPOs) are assigned a 6-digit alphanumeric CCN.
The first 2 digits identify the State code. The third digit is the alpha
character P. The remaining 3 digits are the unique facility identifier.

```{r}
#| label: opo-example
organ("05P001") |> 
  as_data_frame() |> 
  str()
```

## Examples

```{r}
o <- ccn:::get_pin("opo")

o$opo_county |>
  collapse::roworder(code, state, county) |>
  fastplyr::f_group_by(code, state) |>
  fastplyr::f_summarise(
    n = length(county),
    county = stringr::str_to_title(toString(county))
  ) |> 
  fastplyr::f_arrange(-n) |> 
  collapse::rnm(
    n = counties,
    county = county_names
  ) |> 
  collapse::join(o$opo_codes) |> 
  collapse::colorder(code, opo) |>
   gt::gt() |> 
   gt_chamber_theme() |>
   gt::tab_options(quarto.disable_processing = TRUE)
```

### Active

```{r}
o$opo_active |> 
  collapse::roworder(-orig_date) |>
   gt::gt() |> 
   gt_chamber_theme() |>
   gt::tab_options(quarto.disable_processing = TRUE)
```

### Approved Transplant Programs

```{r}
ccn:::get_pin("txc") |>
   gt::gt() |> 
   gt_chamber_theme() |>
   gt::tab_options(quarto.disable_processing = TRUE)
```

